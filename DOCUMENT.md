# SauScript 文档

本文档面向 SauScript v1.3.3

## 程序

SauScript 是一种脚本语言，经编译成语法树之后即可执行。

SauScript 可以编译文件时，也提供了 REPL 程序可供即时求值。

## A + B 问题

下面这个程序将会从控制台输入两个整数，并输出他们的和

```
a := readInt()
b := readInt()
sum := a + b
println(sum)
```

程序从第一行开始，最后一行结束，`:=` 运算符可以定义变量。类型根据上下文推断。

`println` 函数输出结果并换行，返回 `void`。

程序最后一行的值即为程序的返回值，返回值也会被输出到屏幕上（与 REPL 一致），所以上面的程序也可以写成

```
readInt() + readInt()
```

## 计算 e

下面这个程序会计算自然对数的底数 e：

```
# calculate the base of natural logarithm
# e = 1 + 1/1 + 1/2 + 1/6 + .. + 1/n!
e := 1.0
p := 1.0
for i := 1; i <= 12; ++i {
    print(i)
    if i < 10 { print() }
    println(e)
    p *= i
    e += 1.0 / p
}
e
```

程序输出：

```
1  1.0
2  2.0
3  2.5
4  2.66667
5  2.70833
6  2.71667
7  2.71806
8  2.71825
9  2.71828
10 2.71828
11 2.71828
12 2.71828
2.71828
```

`print` 函数输出之后带一个空格。

除了用这种方式计算 e 之外，SauScript 还在全局预定义了数学常数 e 和数学函数 exp 等可供使用。

## 素数判断

下面这个程序会返回小于输入数字的所有素数。

```
isPrime := fn(t: int): int = {
    if t < 2 { # there is no prime less than 2
        return false
    }
    for i := 2; i * i <= t; ++i { 
        if t % i == 0 {
            return false
        }
    }
    return true
}

m := readInt()
for i := 1; i < m; ++i {
    if isPrime(i) { i } else {}
}
```

输入：`10`

输出：`[2, 3, 5, 7]`





### 语法树

SauScript 附带了语法树生成功能。上面素数判断的代码的语法树如下所示：

![](syntax-tree.svg)

# 附录

## 运算符和字面量

SauScript 的运算符和字面量优先级从低到高：

| 优先级 | 运算符                                                       | 结合性   |
| ------ | ------------------------------------------------------------ | -------- |
| 0      | `throw return break continue`<br>`:= = += -= *= /= %= >>= <<= &= ^= |=`<br>`?:` |从右到左 |
| 1      | `||`                                                         | 从左到右 |
| 2      | `&&`                                                         | 从左到右 |
| 3      | `|`                                                          | 从左到右 |
| 4      | `^`                                                          | 从左到右 |
| 5      | `&`                                                          | 从左到右 |
| 6      | `== !=`                                                      | 从左到右 |
| 7      | `< > <= >=`                                                  | 从左到右 |
| 8 | `<=>` | 从左到右 |
| 9      | `<< >>`                                                      | 从左到右 |
| 10     | `+ -`                                                        | 从左到右 |
| 11     | `* / %`                                                      | 从左到右 |
| 12     | `! ~`<br>`+ - ++ --`（前缀）                                 | 从右到左 |
| 13     | `++ --`（后缀）<br>`()`（函数调用）`[]`（下标访问）             | 从左到右 |
| 14 | `true false __LINE__ nan inf`<br>`if-else try-catch while for fn` | 从左到右 |
